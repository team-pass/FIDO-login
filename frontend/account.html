<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- SEO meta tags -->
    <meta
      name="description"
      content="This is a user account page created by Team PASS: an undergraduate Gemstone research team from UMD studying cybersecurity."
    />
    <meta name="author" content="Team Pass" />

    <!-- CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./assets/styles/main.css" type="text/css" />

    <title>Team PASS | User Account</title>
    <link rel="icon" type="image/png" href="favicon.png" />
  </head>
  <body>
    <main class="container">
      <img
        src="./assets/images/team-logo.svg"
        alt="Team PASS Logo"
        class="team-logo"
      />
      <section class="row justify-content-center">
        <div class="col-6 card">
          <div class="card-body">
            <h3 class="card-title">Account</h3>

            <!--User Account Form-->
            
          </div>
          Your email is: <div id="email"></div>
          Your password is: <div id="password"></div>

          <canvas width="400" height="400" id="game"></canvas>
          <script>
          var canvas = document.getElementById('game');
          var context = canvas.getContext('2d');
          
          var grid = 16;
          var count = 0;
            
          var snake = {
            x: 160,
            y: 160,
            
            // snake velocity. moves one grid length every frame in either the x or y direction
            dx: grid,
            dy: 0,
            
            // keep track of all grids the snake body occupies
            cells: [],
            
            // length of the snake. grows when eating an apple
            maxCells: 4
          };
          var apple = {
            x: 320,
            y: 320
          };
          
          // get random whole numbers in a specific range
          // @see https://stackoverflow.com/a/1527820/2124254
          function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min)) + min;
          }
          
          // game loop
          function loop() {
            requestAnimationFrame(loop);
          
            // slow game loop to 15 fps instead of 60 (60/15 = 4)
            if (++count < 4) {
              return;
            }
          
            count = 0;
            context.clearRect(0,0,canvas.width,canvas.height);
          
            // move snake by it's velocity
            snake.x += snake.dx;
            snake.y += snake.dy;
          
            // wrap snake position horizontally on edge of screen
            if (snake.x < 0) {
              snake.x = canvas.width - grid;
            }
            else if (snake.x >= canvas.width) {
              snake.x = 0;
            }
            
            // wrap snake position vertically on edge of screen
            if (snake.y < 0) {
              snake.y = canvas.height - grid;
            }
            else if (snake.y >= canvas.height) {
              snake.y = 0;
            }
          
            // keep track of where snake has been. front of the array is always the head
            snake.cells.unshift({x: snake.x, y: snake.y});
          
            // remove cells as we move away from them
            if (snake.cells.length > snake.maxCells) {
              snake.cells.pop();
            }
          
            // draw apple
            context.fillStyle = 'red';
            context.fillRect(apple.x, apple.y, grid-1, grid-1);
          
            // draw snake one cell at a time
            context.fillStyle = 'green';
            snake.cells.forEach(function(cell, index) {
              
              // drawing 1 px smaller than the grid creates a grid effect in the snake body so you can see how long it is
              context.fillRect(cell.x, cell.y, grid-1, grid-1);  
          
              // snake ate apple
              if (cell.x === apple.x && cell.y === apple.y) {
                snake.maxCells++;
          
                // canvas is 400x400 which is 25x25 grids 
                apple.x = getRandomInt(0, 25) * grid;
                apple.y = getRandomInt(0, 25) * grid;
              }
          
              // check collision with all cells after this one (modified bubble sort)
              for (var i = index + 1; i < snake.cells.length; i++) {
                
                // snake occupies same space as a body part. reset game
                if (cell.x === snake.cells[i].x && cell.y === snake.cells[i].y) {
                  snake.x = 160;
                  snake.y = 160;
                  snake.cells = [];
                  snake.maxCells = 4;
                  snake.dx = grid;
                  snake.dy = 0;
          
                  apple.x = getRandomInt(0, 25) * grid;
                  apple.y = getRandomInt(0, 25) * grid;
                }
              }
            });
          }
          
          // listen to keyboard events to move the snake
          document.addEventListener('keydown', function(e) {
            // prevent snake from backtracking on itself by checking that it's 
            // not already moving on the same axis (pressing left while moving
            // left won't do anything, and pressing right while moving left
            // shouldn't let you collide with your own body)
            
            // left arrow key
            if (e.which === 37 && snake.dx === 0) {
              snake.dx = -grid;
              snake.dy = 0;
            }
            // up arrow key
            else if (e.which === 38 && snake.dy === 0) {
              snake.dy = -grid;
              snake.dx = 0;
            }
            // right arrow key
            else if (e.which === 39 && snake.dx === 0) {
              snake.dx = grid;
              snake.dy = 0;
            }
            // down arrow key
            else if (e.which === 40 && snake.dy === 0) {
              snake.dy = grid;
              snake.dx = 0;
            }
          });
          function processForm(){
                var parameters = location.search.substring(1).split("&");
                if(parameters.length == 2) {
                    var temp = parameters[0].split("=");
                    l = unescape(temp[1]);
                    document.getElementById("email").innerHTML = l;
                    temp = parameters[1].split("=");
                    l = unescape(temp[1]);
                    document.getElementById("password").innerHTML = l;
                }
            }
            processForm();
          // start the game
          requestAnimationFrame(loop);
          </script>

          <small class="form-text text-muted"
                >Go back to
                <a href="./registration.html">registeration</a>
          </small>
        </div>
      </section>
    </main>


    <!-- Bootstrap JS Libraries (jQuery, Popper, and Bootstrap) -->
    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
